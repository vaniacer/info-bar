#!/bin/bash

case $1 in '--remove' | '-r') sed '/[oOº]_[oOº]/d' -i ~/.bashrc; exit 0;; esac

cat >> ~/.bashrc << 'EOF'
#---------------------------------------------{ Info bar }----------------------------------------------+ o_o
faces=(O_o o_O o_o O_O º_o º_O O_º o_º º_º); facesN=${#faces[@]} # Face types                         # | o_º
declare -A paint=( # Colors     |   Effects                                                           # | O_O
                [green]='\e[32m' [norm]='\e[0m'                                                       # | O_o
                [yelow]='\e[33m' [bold]='\e[1m'                                                       # | O_o
                 [blue]='\e[94m'  [dim]='\e[2m')                                                      # | o_o
#-------------------------------------------------------------------------------------------------------+ º_O
face() { printf "${paint[yelow]}${faces[$((RANDOM % $facesN))]}${paint[norm]}"; } # Random face       # | º_º
info() {                                                                                              # | o_º
    [[ -d .git ]] && {  # If in git project folder add git status to info bar output                  # | O_o
        git_clr=('GIT' $(git -c color.ui=always status -sb)) # Colored output 4 info                  # | o_O
        git_tst=('GIT' $(git                    status -sb)) # Simple  output 4 test                  # | o_o
    }                                                                                                 # | o_º
    printf -v line "%${COLUMNS}s"                            # Fill line var with spaces              # | O_o
    line="${paint[green]}${line// /-}${paint[norm]}\n"       # Add color and change ' ' to '-'        # | O_o
    date=$(printf "%(%a %d %b %T)T")                         # Date & time 4 test                     # | O_o
    test=" O_o $PWD  ${git_tst[*]} $date o_O "               # Test string                            # | o_o
    step=$[$COLUMNS-${#test}]; [[ $step -lt 0 ]] && step=0   # Count spaces                           # | o_º
    home="${paint[bold]}${paint[blue]}$PWD${paint[norm]}"    # Home dir info                          # | o_o
    date="${paint[dim]}$date${paint[norm]}"                  # Add color to date & time               # | O_o
           #------+-----+-------+--------+-------------+-----+-------+--------+                       # | o_o
           # Line | O_o |homedir| Spaces | Git  status | Date|  o_O  |  Line  |                       # | o_O
           #------+-----+-------+--------+-------------+-----+-------+--------+                       # | O_O
    printf "$line $(face) $home %${step}s ${git_clr[*]} $date $(face) \n$line" # Final info string    # | O_o
}                                                                                                     # | O_o
#-------------------------------------------------------------------------------------------------------+ o_o
PS1='${debian_chroot:+($debian_chroot)}\n$(info)\n$ '                                                 # | º_O
                                                                                                      # | o_º
case "$TERM" in xterm*|rxvt*)                                                                         # | O_o
    PS1="\[\e]0;${debian_chroot:+($debian_chroot)} ${faces[$((RANDOM % ${#faces[@]}))]} \w\a\]$PS1";; # | O_º
esac                                                                                                  # | o_O
#-------------------------------------------------------------------------------------------------------+ O_o
EOF
